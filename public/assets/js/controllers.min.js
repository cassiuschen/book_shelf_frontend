window.ionicApp.controller("HomeController",["$scope","$rootScope","$http","$ionicLoading","$timeout",function(o,n,r){return o.data={},o.clearSearch=function(){return o.data.searchQuery=""},o.doRefresh=function(){return n.showLoading(),r({method:"GET",url:window.ApiBaseUrl+"books.json",isArray:!0}).success(function(r){return o.books=r,n.hideLoading(),o.$broadcast("scroll.refreshComplete")})},o.doRefresh()}]).controller("BookDetailController",["$scope","$rootScope","$http","$ionicLoading","$timeout","$stateParams",function(o,n,r,t,e,i){o.book={},o.getInfo=function(){return n.showLoading(),r({method:"GET",url:window.ApiBaseUrl+"book.json",params:{id:i.BookId},isArray:!0}).success(function(n){var r,t;return o.book=n,o.rating=Math.round(o.book.rating.average/2),o.rating_up=function(){r=[];for(var n=0,t=o.rating;t>=0?t>n:n>t;t>=0?n++:n--)r.push(n);return r}.apply(this),o.rating_down=function(){t=[];for(var n=0,r=5-o.rating;r>=0?r>n:n>r;r>=0?n++:n--)t.push(n);return t}.apply(this),o.hideLoading(),o.$broadcast("scroll.refreshComplete")}).error(function(){return n.hideLoading(),n.showLoading("当前服务有问题，请稍后再试！"),e(function(){return n.hideLoading()},1e3)})},o.getInfo()}]).controller("BorrowController",["$scope","$rootScope","$http","$ionicLoading","$timeout","$stateParams",function(o,n,r,t,e,i){o.info={},o.getTitle=function(){return n.showLoading("请稍后..."),r({method:"GET",url:window.ApiBaseUrl+"book.json",params:{id:i.BookId,attr:"title"}}).success(function(r){return o.info.title=r.result,n.hideLoading()}).error(function(){return n.hideLoading(),o.showLoading("当前网络有问题，请稍后再试！"),e(function(){return n.hideLoading()},1e3)})},o.getTitle(),o.postApplication=function(){return n.showLoading(),r({method:"POST",url:window.ApiBaseUrl+"borrow/"+i.BookId+".json",data:{borrow:{target:o.info.name,phone:o.info.phone}}}).success(function(o){return n.hideLoading(),n.showLoading(200===o.status?"申请成功！":"当前无法提交申请\n请稍后再试"),e(function(){return n.hideLoading()},1e3)}).error(function(){return n.hideLoading(),n.showLoading("当前无法提交申请\n请稍后再试"),e(function(){return n.hideLoading()},1e3)})}}]).controller("DoubanInfoController",["$scope","$http","$stateParams",function(){}]).controller("AboutController",["$scope",function(o){return o.test="Test is success!"}]).controller("LoadingController",["$scope","$ionicLoading",function(o,n){return o.show=function(){return n.show({template:"加载中"})},o.gide=function(){return n.hide()}}]);